{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Wrapper","styled","div","H1","h1","Uploader","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","window","test","type","size","error","upload","then","success","console","log","catch","tip","spinning","isLoading","className","InboxOutlined","target","href","filename","src","placeholder","ref","onChange","current","value","fullStr","Title","Main","Header","Tips","username","Home"],"mappings":"mgBASOA,EAAWC,IAAXD,QAEDE,EAAUC,IAAOC,IAAV,KAQPC,EAAKF,IAAOG,GAAV,KAuGOC,EAnGEC,aAAS,WAAO,IAAD,EACEC,cAAzBC,EADuB,EACvBA,WAAYC,EADW,EACXA,UACbC,EAAOC,mBACPC,EAAOD,mBACPE,EAAQC,aAAc,iBAAO,CACjCC,MAAO,KACPC,SAFiC,SAExBD,GACPF,EAAME,MAAQA,GAEhB,eACE,OAAOF,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAE7CE,OAAQ,KACRC,UATiC,SASvBD,GACRJ,EAAMI,OAASA,GAEjB,gBACE,OAAOJ,EAAMI,OAAN,aAAqBJ,EAAMI,QAAW,IAE/C,cACE,OAAOT,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBR,EAAMS,SAAWT,EAAMU,eASpGC,EAAQ,CACZC,gBAAgB,EAChBC,aAAc,SAAAC,GAGZ,OAFAnB,EAAWoB,QAAQD,GACnBnB,EAAWqB,YAAYF,EAAKG,MACE,OAA1BrB,EAAUsB,aACZC,IAAQC,QAAQ,+CACT,IAETC,OAAOP,KAAOA,EACT,wCAAwCQ,KAAKR,EAAKS,MAInDT,EAAKU,KAAO,SACdL,IAAQM,MAAM,+BACP,IAGT9B,EAAW+B,SACRC,MAAK,SAACrB,GACLa,IAAQS,QAAQ,4BAChBC,QAAQC,IAAIxB,MACXyB,OAAM,WACTZ,IAAQM,MAAM,gCAET,IAfLN,IAAQM,MAAM,0EACP,MAiBb,OACE,6BACE,kBAAC,IAAD,CAAMO,IAAI,qBAAMC,SAAUtC,EAAWuC,WACrC,kBAACjD,EAAY0B,EACX,uBAAGwB,UAAU,wBACX,kBAACC,EAAA,EAAD,OAEF,uBAAGD,UAAU,mBAAb,0DACA,uBAAGA,UAAU,mBAAb,gHAMAxC,EAAWW,WAAa,kBAACnB,EAAD,KACtB,kBAACG,EAAD,iCACA,4BACE,wDACE,uBAAG+C,OAAO,SACPC,KAAM3C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,KAAMb,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,MAEjH,kDACE,8BAAOb,EAAW4C,WAEpB,4BACE,yBAAKC,IAAK7C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,OAE5D,wDACA,4BACE,2BAAOiC,YAAY,mDAAWC,IAAK7C,EAAM8C,SAhEnC,WAChB3C,EAAMG,SAASN,EAAK+C,QAAQC,UAgElB,2BAAOJ,YAAY,mDAAWC,IAAK3C,EAAM4C,SA9DlC,WACjB3C,EAAMK,UAAUN,EAAK6C,QAAQC,WA+DrB,4BACE,uBAAGR,OAAO,SAASC,KAAMtC,EAAM8C,SAA/B,+BAGO,S,qgBChHrB,IAAMC,EAAM3D,IAAOC,IAAR,KAQL2D,EAAK5D,IAAOC,IAAR,KAEJ4D,EAAO7D,IAAOC,IAAR,KA+BG6D,EAtBJzD,aAAS,WAAK,IAChBG,EAAWF,cAAXE,UACP,OACE,6BAEIA,EAAUsB,YACR,kBAAC8B,EAAD,KACE,kBAACC,EAAD,eACUrD,EAAUsB,YAAYX,WAAW4C,SAD3C,yCAIA,kBAAC,EAAD,OAEF,kBAACJ,EAAD,mHCjCJK,EAAK3D,aAAS,WAClB,OACE,kBAAC,EAAD,SAGW2D","file":"static/js/9.d1e56ad1.chunk.js","sourcesContent":["import React, {useRef} from \"react\";\r\nimport {observer, useLocalStore} from \"mobx-react\";\r\nimport {useStores} from \"../stores\";\r\nimport {Upload,Spin} from 'antd';\r\nimport {InboxOutlined} from '@ant-design/icons';\r\nimport {message} from 'antd'\r\nimport styled from 'styled-components';\r\n\r\n\r\nconst {Dragger} = Upload;\r\n\r\nconst Wrapper = styled.div`\r\n  border: 1px dashed #ccc;\r\n  margin-top: 30px;\r\n  padding: 20px;\r\n    ul li img{\r\n      max-width: 300px;\r\n    }\r\n`\r\nconst H1 = styled.h1`\r\n  margin: 10px;\r\n  text-align: center;\r\n`\r\nconst Uploader = observer(() => {\r\n  const {ImageStore, UserStore} = useStores()\r\n  const ref1 = useRef()\r\n  const ref2 = useRef()\r\n  const store = useLocalStore(() => ({\r\n    width: null,\r\n    setWidth(width) {\r\n      store.width = width\r\n    },\r\n    get widthStr() {\r\n      return store.width ? `/w/${store.width}` : ''\r\n    },\r\n    height: null,\r\n    setHeight(height) {\r\n      store.height = height\r\n    },\r\n    get heightStr() {\r\n      return store.height ? `/h/${store.height}` : ''\r\n    },\r\n    get fullStr() {\r\n      return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\r\n    }\r\n  }));\r\n  const bindWidth = () => {\r\n    store.setWidth(ref1.current.value)\r\n  }\r\n  const bindHeight = () => {\r\n    store.setHeight(ref2.current.value)\r\n  }\r\n  const props = {\r\n    showUploadList: false,\r\n    beforeUpload: file => {\r\n      ImageStore.setFile(file)\r\n      ImageStore.setFilename(file.name)\r\n      if (UserStore.currentUser === null) {\r\n        message.warning('请先登录在上传')\r\n        return false\r\n      }\r\n      window.file = file\r\n      if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\r\n        message.error('只能上传png/svg/jpg/gif格式的图片');\r\n        return false;\r\n      }\r\n      if (file.size > 2018 * 2048) {\r\n        message.error('图片最大2M');\r\n        return false;\r\n      }\r\n\r\n      ImageStore.upload()\r\n        .then((serverFile) => {\r\n          message.success('上传成功')\r\n          console.log(serverFile)\r\n        }).catch(() => {\r\n        message.error('上传失败');\r\n      })\r\n      return false\r\n    }\r\n  }\r\n  return (\r\n    <div>\r\n      <Spin tip=\"加载中\" spinning={ImageStore.isLoading}>\r\n      <Dragger {...props}>\r\n        <p className=\"ant-upload-drag-icon\">\r\n          <InboxOutlined/>\r\n        </p>\r\n        <p className=\"ant-upload-text\">点击或拖拽上传图片</p>\r\n        <p className=\"ant-upload-hint\">\r\n        支持jpg,jpeg,png,svg,gif格式。且最大能上传2M的图片\r\n        </p>\r\n      </Dragger>\r\n      </Spin>\r\n      {\r\n        ImageStore.serverFile ? <Wrapper>\r\n          <H1>上传结果</H1>\r\n          <ul>\r\n            <li>原图预览:\r\n              <a target=\"_blank\"\r\n                 href={ImageStore.serverFile.attributes.url.attributes.url}>{ImageStore.serverFile.attributes.url.attributes.url}</a>\r\n            </li>\r\n            <li>文件名:\r\n              <span>{ImageStore.filename}</span>\r\n            </li>\r\n            <li>\r\n              <img src={ImageStore.serverFile.attributes.url.attributes.url}/>\r\n            </li>\r\n            <li>尺寸定制</li>\r\n            <li>\r\n              <input placeholder=\"最大宽度（可选）\" ref={ref1} onChange={bindWidth}/>\r\n              <input placeholder=\"最小高度（可选）\" ref={ref2} onChange={bindHeight}/>\r\n            </li>\r\n            <li>\r\n              <a target=\"_blank\" href={store.fullStr}>完成预览</a>\r\n            </li>\r\n          </ul>\r\n        </Wrapper> : null\r\n      }\r\n    </div>\r\n  )\r\n})\r\nexport default Uploader;","import {observer} from \"mobx-react\";\r\nimport {useStores} from \"../stores\";\r\nimport Uploader from \"./Uploader\";\r\nimport React from \"react\";\r\nimport styled from 'styled-components';\r\nconst Title=styled.div`\r\n  background: rgb(255,242,240);\r\n  padding: 20px 0;\r\n  text-align: center;\r\n  font-size: 18px;\r\n  color: #666;\r\n  border: 1px solid red;\r\n`\r\nconst Main=styled.div`\r\n`\r\nconst Header=styled.div`\r\n  background: rgb(246,255,237);\r\n  padding: 6px 0;\r\n  margin-bottom: 10px;\r\n  text-align: center;\r\n  font-size: 12px;\r\n  color: #333333;\r\n  border: 1px solid green;\r\n`\r\nconst Tips=observer(()=>{\r\n  const {UserStore}=useStores()\r\n  return(\r\n    <div>\r\n      {\r\n        UserStore.currentUser ?\r\n          <Main>\r\n            <Header>\r\n              Hello, {UserStore.currentUser.attributes.username}，\r\n              欢迎登录！\r\n            </Header>\r\n            <Uploader/>\r\n          </Main> :\r\n          <Title>\r\n            为了更好的使用本产品，请您先登录！\r\n          </Title>\r\n      }\r\n\r\n    </div>\r\n\r\n  )\r\n})\r\nexport default Tips","import React from \"react\";\nimport {observer} from \"mobx-react\";\nimport Tips from \"../components/Tips\";\n\nconst Home=observer(()=>{\n  return(\n    <Tips/>\n  )\n})\nexport default Home;"],"sourceRoot":""}